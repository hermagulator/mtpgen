#!/bin/bash

# Flush existing rules (optional: only use if you want to start fresh)
iptables -F
ip6tables -F

# Block IPv4 ranges
for ip in \
185.126.28.0/22 \
188.34.128.0/17 \
185.226.99.0/24 \
194.62.106.0/24 \
78.138.62.0/24 \
185.189.228.0/24 \
136.243.0.0/16 \
185.107.52.0/22 \
65.109.0.0/16 \
185.189.231.0/24 \
159.69.0.0/16 \
185.216.237.0/24 \
197.242.84.0/22 \
95.217.0.0/16 \
185.189.229.0/24 \
216.55.108.0/22 \
91.233.8.0/22 \
91.190.240.0/21 \
78.46.0.0/15 \
201.131.3.0/24 \
116.202.0.0/16 \
88.198.0.0/16 \
185.50.120.0/23 \
178.212.75.0/24 \
185.228.8.0/23 \
204.29.146.0/24 \
194.42.180.0/22 \
185.171.224.0/22 \
91.107.128.0/17 \
168.119.0.0/16 \
188.40.0.0/16 \
178.63.0.0/16 \
138.199.128.0/17 \
195.201.0.0/16 \
95.216.0.0/16 \
5.75.128.0/17 \
128.140.0.0/17 \
88.99.0.0/16 \
193.163.198.0/24 \
65.21.0.0/16 \
185.213.45.0/24 \
213.239.192.0/18 \
46.62.128.0/17 \
157.90.0.0/16 \
85.10.192.0/18 \
135.181.0.0/16 \
185.157.176.0/23 \
116.203.0.0/16 \
142.132.128.0/17 \
193.25.170.0/23 \
171.25.225.0/24 \
23.88.0.0/17 \
37.27.0.0/16 \
185.189.230.0/24 \
194.42.184.0/22 \
195.60.226.0/24 \
139.28.242.0/23 \
49.13.0.0/16 \
49.12.0.0/16 \
185.157.83.0/24 \
193.110.6.0/23 \
176.9.0.0/16 \
65.108.0.0/16 \
167.233.0.0/16 \
144.76.0.0/16 \
162.55.0.0/16 \
188.245.0.0/16 \
157.180.0.0/17 \
5.9.0.0/16 \
138.201.0.0/16 \
46.4.0.0/16 \
91.99.0.0/16 \
195.248.224.0/24 \
148.251.0.0/16 \
213.133.96.0/19 \
167.235.0.0/16 \
185.157.178.0/23 \
94.130.0.0/16 \
45.145.227.0/24 \
5.78.66.0/24 \
5.78.121.0/24 \
5.78.77.0/24 \
5.78.130.0/24 \
5.78.24.0/24 \
5.78.62.0/24 \
5.78.113.0/24 \
5.78.116.0/24 \
5.78.96.0/24 \
5.78.89.0/24 \
5.78.127.0/24 \
5.78.103.0/24 \
5.78.117.0/24 \
5.78.93.0/24 \
5.78.56.0/24 \
5.78.43.0/24 \
5.78.110.0/24 \
5.78.111.0/24 \
5.78.118.0/24 \
5.78.47.0/24 \
5.78.51.0/24 \
5.78.114.0/24 \
5.78.76.0/24 \
5.78.115.0/24 \
5.78.97.0/24 \
5.78.100.0/24 \
5.78.119.0/24 \
5.78.75.0/24 \
5.78.73.0/24 \
5.78.102.0/24 \
5.78.61.0/24 \
5.78.87.0/24 \
5.78.131.0/24 \
5.78.104.0/24 \
5.78.0.0/16 \
5.78.98.0/24 \
5.78.99.0/24 \
5.78.45.0/24 \
5.78.68.0/24 \
5.78.84.0/24 \
5.78.124.0/24 \
5.78.122.0/24 \
5.78.85.0/24 \
5.78.78.0/24 \
5.78.64.0/24 \
5.78.101.0/24 \
5.78.55.0/24 \
5.78.59.0/24 \
5.78.67.0/24 \
5.78.91.0/24 \
5.78.70.0/24 \
5.78.123.0/24 \
5.78.74.0/24 \
5.78.108.0/24 \
5.78.92.0/24 \
5.78.49.0/24 \
5.78.60.0/24 \
5.78.41.0/24 \
5.78.132.0/24 \
5.78.54.0/24 \
5.78.44.0/24 \
5.78.28.0/24 \
5.78.82.0/24 \
5.78.80.0/24 \
5.78.53.0/24 \
5.78.105.0/24 \
5.78.88.0/24 \
5.78.30.0/24 \
5.78.57.0/24 \
5.78.106.0/24 \
5.78.71.0/24 \
5.78.31.0/24 \
5.78.94.0/24 \
5.78.128.0/24 \
5.78.69.0/24 \
5.78.79.0/24 \
5.78.42.0/24 \
5.78.48.0/24 \
5.78.107.0/24 \
5.78.160.0/22 \
5.78.120.0/24 \
5.78.50.0/24 \
5.78.52.0/24 \
5.78.40.0/24 \
5.78.86.0/24 \
5.78.90.0/24 \
5.78.8.0/21 \
5.78.63.0/24 \
5.78.129.0/24 \
5.78.126.0/24 \
5.78.81.0/24 \
5.78.109.0/24 \
5.78.58.0/24 \
5.78.83.0/24 \
5.78.46.0/24 \
5.78.65.0/24 \
5.78.112.0/24 \
5.78.72.0/24 \
5.78.95.0/24 \
5.78.125.0/24 \
5.78.16.0/24 \
185.126.28.0/22 \
188.34.128.0/17 \
185.226.99.0/24 \
194.62.106.0/24 \
78.138.62.0/24 \
185.189.228.0/24 \
136.243.0.0/16 \
185.107.52.0/22 \
65.109.0.0/16 \
185.189.231.0/24 \
159.69.0.0/16 \
185.216.237.0/24 \
197.242.84.0/22 \
95.217.0.0/16 \
185.189.229.0/24 \
216.55.108.0/22 \
91.233.8.0/22 \
91.190.240.0/21 \
78.46.0.0/15 \
201.131.3.0/24 \
116.202.0.0/16 \
88.198.0.0/16 \
185.50.120.0/23 \
178.212.75.0/24 \
185.228.8.0/23 \
204.29.146.0/24 \
194.42.180.0/22 \
185.171.224.0/22 \
91.107.128.0/17 \
168.119.0.0/16 \
188.40.0.0/16 \
178.63.0.0/16 \
138.199.128.0/17 \
195.201.0.0/16 \
95.216.0.0/16 \
5.75.128.0/17 \
128.140.0.0/17 \
88.99.0.0/16 \
193.163.198.0/24 \
65.21.0.0/16 \
185.213.45.0/24 \
213.239.192.0/18 \
46.62.128.0/17 \
157.90.0.0/16 \
85.10.192.0/18 \
135.181.0.0/16 \
185.157.176.0/23 \
116.203.0.0/16 \
142.132.128.0/17 \
193.25.170.0/23 \
171.25.225.0/24 \
23.88.0.0/17 \
37.27.0.0/16 \
185.189.230.0/24 \
194.42.184.0/22 \
195.60.226.0/24 \
139.28.242.0/23 \
49.13.0.0/16 \
49.12.0.0/16 \
185.157.83.0/24 \
193.110.6.0/23 \
176.9.0.0/16 \
65.108.0.0/16 \
167.233.0.0/16 \
144.76.0.0/16 \
162.55.0.0/16 \
188.245.0.0/16 \
157.180.0.0/17 \
5.9.0.0/16 \
138.201.0.0/16 \
46.4.0.0/16 \
91.99.0.0/16 \
195.248.224.0/24 \
148.251.0.0/16 \
213.133.96.0/19 \
167.235.0.0/16 \
185.157.178.0/23 \
94.130.0.0/16 \
45.145.227.0/24
do
    iptables -A INPUT -s $ip -j DROP
    iptables -A OUTPUT -d $ip -j DROP
done

# Block IPv6 ranges
for ip6 in \
2a12:1fc0::/42 \
2a06:be80::/29 \
2a0e:7700::/32 \
2a01:4f9::/32 \
2a01:4f8::/32 \
2a12:1fc0::/42 \
2a01:4ff:100::/40 \
2a01:4f9::/32 \
2a01:4f8::/32 \
2a0e:7700::/32 \
2a11:e980::/29 \
2a06:be80::/29 \
2a11:e980::/29
do
    ip6tables -A INPUT -s $ip6 -j DROP
    ip6tables -A OUTPUT -d $ip6 -j DROP
done

# Save the rules (to persist after reboot)
iptables-save > /etc/iptables/rules.v4
ip6tables-save > /etc/iptables/rules.v6

echo "Blocking rules applied successfully."
